#!/bin/bash

set -ueo pipefail

function log_info() { echo -e "\033[00m$(date +'%Y-%m-%d %H:%M:%S %z') $@\033[0m" > /dev/tty;          }
function log_warn() { echo -e "\033[33m$(date +'%Y-%m-%d %H:%M:%S %z') $@\033[0m" > /dev/tty;          }
function log_erro() { echo -e "\033[31m$(date +'%Y-%m-%d %H:%M:%S %z') $@\033[0m" > /dev/tty; exit -1; }

log_info
log_info "查找合法的IP: "

v='\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5]'
grep -P -o "^\s*(($v)\.){3}($v)\s*\$" <<EOF
0.0.0.0
255.255.255.255
256.255.255.255
1.2.3.4
1000.2.3.4
1
1.
1.2
1.2.
1.2.3
1.2.3.4
1.2.3.4.
1.2.3.4.5
10.2.3.4
EOF

log_info "查找合法的IP: "

v='[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]'
grep -E -o "^\s*(($v)\.){3}($v)\s*\$" <<EOF
0.0.0.0
255.255.255.255
256.255.255.255
1.2.3.4
1000.2.3.4
1
1.
1.2
1.2.
1.2.3
1.2.3.4
1.2.3.4.
1.2.3.4.5
10.2.3.4
EOF

log_info "测试合法的固定电话: "

grep -P -o '^\s*((\()?0\d{1,3}(?(2)\)|-))?\d{7}\s*$' << EOF
5
57
575
5757
57570
575702
5757023
57570234

0-5757023
03-5757023
035-5757023
0354-5757023
03545-5757023

0354-5
0354-57
0354-575
0354-5757
0354-57570
0354-575702
0354-5757023
0354-57570234

0-5
0-57
0-575
0-5757
0-57570
0-575702
0-5757023
0-57570234

03545-5
03545-57
03545-575
03545-5757
03545-57570
03545-575702
03545-5757023
03545-57570234

(0)5757023
(03)5757023
(035)5757023
(0354)5757023
(03545)5757023

(0354)5
(0354)57
(0354)575
(0354)5757
(0354)57570
(0354)575702
(0354)5757023
(0354)57570234

(0)5
(0)57
(0)575
(0)5757
(0)57570
(0)575702
(0)5757023
(0)57570234

(03545757023
 03545757023
(0354-5757023
(0354)-5757023
((0354)5757023
(0354))5757023
((0354))5757023
)0354-5757023

03545757023
EOF

log_info "测试合法的固定电话: "
grep -P -o '^\s*(0\d{1,3}-|\(0\d{1,3}\))\d{7}\s*$' << EOF
5
57
575
5757
57570
575702
5757023
57570234

0-5757023
03-5757023
035-5757023
0354-5757023
03545-5757023

0354-5
0354-57
0354-575
0354-5757
0354-57570
0354-575702
0354-5757023
0354-57570234

0-5
0-57
0-575
0-5757
0-57570
0-575702
0-5757023
0-57570234

03545-5
03545-57
03545-575
03545-5757
03545-57570
03545-575702
03545-5757023
03545-57570234

(0)5757023
(03)5757023
(035)5757023
(0354)5757023
(03545)5757023

(0354)5
(0354)57
(0354)575
(0354)5757
(0354)57570
(0354)575702
(0354)5757023
(0354)57570234

(0)5
(0)57
(0)575
(0)5757
(0)57570
(0)575702
(0)5757023
(0)57570234

(03545757023
 03545757023
(0354-5757023
(0354)-5757023
((0354)5757023
(0354))5757023
((0354))5757023
)0354-5757023

03545757023
EOF

