
# 操作系统-打包和压缩
## 压缩命令需要考虑的问题
```
* 压缩, 能否压缩目录
* 压缩, 能否跳过文件
* 压缩, 能否跳过目录
* 压缩, 使用  精确名称跳过文件或目录时, 也会跳过子目录的文件或目录 -- 通用(不包括 zip gunzip, 下同)
* 压缩, 使用通配符名称跳过文件或目录时, 也会跳过子目录的文件或目录(假设没有和通配符相同的文件) -- 通用
* 压缩, 是否可以保留符号链接
* 压缩, 能否完整保留 Linux 权限, 比如 suid
* 压缩, 是否删除源文件
* 压缩, 目标文件已存在时, 怎么办?
* 解压, 是否可以指定解压目录
* 解压, 是否可以只解压部分文件
* 解压, 是否可以只解压部分目录
* 解压, 使用  精确名称指定部分文件或目录时, 需要从顶层目录开始指定 -- 通用
* 解压, 使用通配符名称指定部分文件或目录时, 也会跳过子目录的文件或目录(假设没有和通配符相同的文件) -- 通用
* 解压, 是否可以跳过部分文件
* 解压, 是否可以跳过部分目录
* 解压, 使用  精确名称跳过部分文件或目录时, 需要从顶层目录开始指定 -- 通用
* 解压, 使用通配符名称跳过部分文件或目录时, 也会跳过子目录的文件或目录(假设没有和通配符相同的文件) -- 通用
* 解压, 能否完整保留 Linux 权限, 比如 suid
* 解压, 是否删除源文件
* 解压, 目标文件已存在时, 怎么办?
* 查看, 查看部分文件或跳过部分文件要考虑的问题同解压
```

## tar
```
* 压缩, 能否压缩目录                            -- 可以(其实是先打包后压缩)
* 压缩, 能否跳过文件                            -- 可以
* 压缩, 能否跳过目录                            -- 可以
* 压缩, 是否可以保留符号链接                    -- 可以
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 压缩, 是否删除源文件                          -- 不会
* 压缩, 目标文件已存在时, 怎么办?               -- 删除旧文件, 生成新文件
* 解压, 是否可以指定解压目录                    -- 可以
* 解压, 是否可以只解压部分文件                  -- 可以
* 解压, 是否可以只解压部分目录                  -- 可以
* 解压, 是否可以跳过部分文件                    -- 可以
* 解压, 是否可以跳过部分目录                    -- 可以
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 解压, 是否删除源文件                          -- 不会
* 解压, 目标文件已存在时, 怎么办?               -- 更新压缩包里存在的文件, 压缩包里不存在的文件保持不变

tar             acf 1.tgz                   ... # 打包并压缩, 根据后缀自动选择压缩类型
tar            vacf 1.tgz                   ... # 打包并压缩, 显示压缩过程
tar             acf 1.tgz -X 1.txt          ... # 打包并压缩, 跳过 1.txt 内的文件
tar             acf 1.tgz --exclude "..."   ... # 打包并压缩, 跳过文件或目录
tar              xf 1.tgz                       # 解压, 根据后缀自动选择压缩类型
tar             vxf 1.tgz                       # 解压, 显示解压过程
tar             pxf 1.tgz                       # 解压, 完整还原权限, 比如, suid
tar              xf 1.tgz -C ...                # 解压, 指定解压目录
tar              xf 1.tgz            1.txt      # 解压部分文件或目录, 精确
tar --wildcards -xf 1.tgz           "*.txt"     # 解压部分文件或目录, 通配符, 有的版本不需要 --wildcards
tar              xf 1.tgz --exclude  1.txt      # 解压跳过部分文件或目录, 精确
tar --wildcards -xf 1.tgz --exclude "*.txt"     # 解压跳过部分文件或目录, 通配符, 有的版本不需要 --wildcards
tar              tf 1.tgz                       # 列出压缩包中的文件和目录, 根据后缀自动选择压缩类型
tar             vtf 1.tgz                       # 列出压缩包中的文件和目录, 包括权限, 所属用户等
tar              tf 1.tgz  ...                  # 列出压缩包中的指定文件或目录, 说明同解压

tar cf 1.tar ... # 打包
tar xf 1.tar     # 解包
tar tf 1.tar     # 查看包
tar rf 1.tar ... # 添加包
tar uf 1.tar ... # 更新包

tar zcf 1.tgz ... # 打包并压缩 gzip
tar zxf 1.tgz     # 解压并解包 gzip
tar ztf 1.tgz     # 查看

tar zcf 1.tar.gz ... # 打包并压缩 gzip
tar zxf 1.tar.gz     # 解压并解包 gzip
tar ztf 1.tar.gz     # 查看

tar jcf 1.tar.bz2 ... # 打包并压缩 bz2
tar jxf 1.tar.bz2     # 解压并解包 bz2
tar jtf 1.tar.bz2     # 查看

tar Zcf 1.Z ... # 打包并压缩 compress
tar Zxf 1.Z     # 解压并解包 compress
tar Ztf 1.Z     # 查看
```

## gzip gunzip
```
* 压缩, 能否压缩目录                            -- 不能
* 压缩, 能否跳过文件                            -- 不能, 只有一个文件
* 压缩, 能否跳过目录                            -- 不能
* 压缩, 是否可以保留符号链接                    -- 不能, 只有一个文件, 符号链接没意义
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 会
* 压缩, 目标文件已存在时, 怎么办?               -- 会提醒是否覆盖
* 解压, 是否可以指定解压目录                    -- 不能
* 解压, 是否可以只解压部分文件                  -- 不能, 只有一个文件
* 解压, 是否可以只解压部分目录                  -- 不能
* 解压, 是否可以跳过部分文件                    -- 不能, 只有一个文件
* 解压, 是否可以跳过部分目录                    -- 不能
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 会
* 解压, 目标文件已存在时, 怎么办?               -- 会提醒是否覆盖

gzip      ...       #     压缩
gzip  -r ....       # 递归压缩
gzip  -l 1.gz       #     列出 1.gz 内文件
gzip  -d 1.gz       #   解压缩
gunzip   1.gz       #   解压缩
gunzip   1.tgz      #   解压缩
```

## bzip2 bunzip2
```
* 压缩, 能否压缩目录                            -- 不能
* 压缩, 能否跳过文件                            -- 不能, 只有一个文件
* 压缩, 能否跳过目录                            -- 不能
* 压缩, 是否可以保留符号链接                    -- 不能, 只有一个文件, 符号链接没意义
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 默认会删除
* 压缩, 目标文件已存在时, 怎么办?               -- 默认会报错
* 解压, 是否可以指定解压目录                    -- 不能
* 解压, 是否可以只解压部分文件                  -- 不能, 只有一个文件
* 解压, 是否可以只解压部分目录                  -- 不能
* 解压, 是否可以跳过部分文件                    -- 不能, 只有一个文件
* 解压, 是否可以跳过部分目录                    -- 不能
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 默认会删除
* 解压, 目标文件已存在时, 怎么办?               -- 默认会报错

bzip2       ...    #   压缩,   删除源文件, 目标文件已存在时报错
bzip2   -f  ...    #   压缩,   删除源文件, 目标文件已存在时覆盖
bzip2   -k  ...    #   压缩, 不删除源文件
bzip2   -v  ...    #   压缩,   显示压缩过程
bzip2   -q  ...    #   压缩, 不显示压缩过程
bzip2   -d  1.bz2  # 解压缩, 其他组合选项同压缩
bunzip2     1.bz2  # 解压缩, 其他组合选项同压缩
```

## compress uncompress
```
* 压缩, 能否压缩目录                            -- 不能
* 压缩, 能否跳过文件                            -- 不能, 只有一个文件
* 压缩, 能否跳过目录                            -- 不能
* 压缩, 是否可以保留符号链接                    -- 不能, 只有一个文件, 符号链接没意义
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 会
* 压缩, 目标文件已存在时, 怎么办?               -- 默认会提醒是否覆盖
* 解压, 是否可以指定解压目录                    -- 不能
* 解压, 是否可以只解压部分文件                  -- 不能, 只有一个文件
* 解压, 是否可以只解压部分目录                  -- 不能
* 解压, 是否可以跳过部分文件                    -- 不能, 只有一个文件
* 解压, 是否可以跳过部分目录                    -- 不能
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 会
* 解压, 目标文件已存在时, 怎么办?               -- 默认会提醒是否覆盖

  compress    ...  #   压缩, 目标文件已存在时可选择是否覆盖
  compress -f ...  #   压缩, 目标文件已存在时覆盖
  compress -r ...  #   压缩, 递归
  compress -d 1.Z  # 解压缩, 其他组合选项同压缩
uncompress    1.Z  # 解压缩, 其他组合选项同压缩
```

## zip unzip
```
* 压缩, 能否压缩目录                            -- 可以
* 压缩, 能否跳过文件                            -- 可以
* 压缩, 能否跳过目录                            -- 可以
* 压缩, 是否可以保留符号链接                    -- 默认使用符号链接所指向的文件
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 默认不会
* 压缩, 目标文件已存在时, 怎么办?               -- 不会删除旧文件, 只会更新旧文件
* 解压, 是否可以指定解压目录                    -- 可以
* 解压, 是否可以只解压部分文件                  -- 可以
* 解压, 是否可以只解压部分目录                  -- 可以
* 解压, 是否可以跳过部分文件                    -- 可以
* 解压, 是否可以跳过部分目录                    -- 可以
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 默认不会
* 解压, 目标文件已存在时, 怎么办?               -- 默认会提醒

zip     1.zip ...             # 压缩文件
zip -r  1.zip ...             # 压缩目录
zip -r  1.zip ... -x  1.txt   # 压缩, 跳过指定文件, 需要从顶层目录开始
zip -r  1.zip ... -x  "111/"  # 压缩, 跳过指定空目录, 需要从顶层目录开始, 精确 (必须包含斜杠)
zip -r  1.zip ... -x  "111/*" # 压缩, 跳过指定  目录, 需要从顶层目录开始, 精确
zip -r  1.zip ... -x "*.txt"  # 压缩, 跳过指定文件,   包括子目录, 通配符, 假设不存在文件 *.txt
zip -rj 1.zip    ...          # 压缩, 所有文件都移到顶层目录
zip -l  1.zip    ...          # 压缩 LF -> LF+CR
zip -ll 1.zip    ...          # 压缩 LF+CR -> LF
zip -m  1.zip    ...          # 压缩, 删除原始文件
zip -q  1.zip    ...          # 压缩, 不显示指令执行过程
zip -y  1.zip    ...          # 压缩, 保存符号链接本身
zip -d  1.zip   1.txt         # 删除 1.zip 里的文件, 需要从顶层路径开始, 精确
zip -d  1.zip  "123/"         # 删除 1.zip 里的空目录, 需要从顶层路径开始, 精确 (必须包含斜杠)
zip -d  1.zip  "123/*"        # 删除 1.zip 里的  目录, 需要从顶层路径开始, 精确
zip -d  1.zip "*.txt"         # 删除 1.zip 里的文件, 包括子目录, 通配符, 假设不存在文件 *.txt
zip -f  1.zip    ...          # 更新 1.zip 里的文件, 不添加
zip -u  1.zip    ...          # 更新 1.zip 里的文件, 不存在时添加, 感觉和默认行为没什么区别
zip -v  1.zip    ...          # 显示执行过程

unzip    1.zip               # 解压
unzip    1.zip   1.txt       # 解压部分文件, 精确, 需要从顶层路径开始
unzip    1.zip    123/       # 解压部分空目录, 精确, 需要从顶层路径开始 (必须包含斜杠)
unzip    1.zip   "123/*"     # 解压部分  目录, 精确, 需要从顶层路径开始
unzip    1.zip   "*.txt"     # 解压部分文件, 通配符, 包括子目录, 假设不存在文件 *.txt
unzip    1.zip -x ...        # 解压缩, 跳过指定文件或目录, 规则同上
unzip    1.zip -d ...        # 解压缩到指定目录
unzip -j 1.zip               # 解压时, 文件都移到顶层路径
unzip -o 1.zip               # 解压时, 直接覆盖重复的文件, 不提醒
unzip -n 1.zip               # 解压时,   不覆盖重复的文件
unzip -l 1.zip               # 列出 1.zip 的目录结构, 简单
unzip -v 1.zip               # 列出 1.zip 的目录结构, 详细点
```

## rar unrar
```
* 压缩, 能否压缩目录                            -- 可以
* 压缩, 能否跳过文件                            --
* 压缩, 能否跳过目录                            --
* 压缩, 是否可以保留符号链接                    -- 默认使用符号链接所指向的文件
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 压缩, 是否删除源文件                          -- 不会
* 压缩, 目标文件已存在时, 怎么办?               -- 不会删除旧文件, 只会更新旧文件
* 解压, 是否可以指定解压目录                    -- 可以
* 解压, 是否可以只解压部分文件                  -- 可以
* 解压, 是否可以只解压部分目录                  -- 可以
* 解压, 是否可以跳过部分文件                    --
* 解压, 是否可以跳过部分目录                    --
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 解压, 是否删除源文件                          -- 不会
* 解压, 目标文件已存在时, 怎么办?               -- 会提醒

rar      a 1.rar ...      #   压缩文件或目录
rar -ol  a 1.rar ...      #   压缩文件或目录, 保留符号链接本身
unrar    v 1.rar          # 列出压缩包信息, 详细
unrar    l 1.rar          # 列出压缩包信息, 简易
unrar    l 1.rar ...      # 列出压缩包内的指定文件或目录
unrar    e 1.rar ...      # 解压缩到指定路径, 忽略压缩包内的路径
unrar    x 1.rar ...      # 解压缩到指定路径, 使用完整的压缩包路径
unrar    x 1.rar ... ...  # 解压缩到指定路径, 使用完整的压缩包路径, 只解压部分文件
```

