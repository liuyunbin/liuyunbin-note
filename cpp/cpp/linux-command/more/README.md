
#### 简介：
本程序用于实现 Linux 命令 more

#### 使用说明：
1. 如果，用户将标准输入重定向到 文件 或 管道时，程序将首先处理标准输入
2. 然后，如果用户提供命令行参数，程序将继续处理命令行参数
3. 如果，用户将标准输出重定向到 文件 或 管道，
    * 对于标准输入，程序直接输出到标准输出
    * 对于命令行参数，程序将打开文件，而后，将其内容输出到标准输出
4. 否则，当输出一页时，将读入用户输入，q 表示退出，回车表示输出下一行，空格表示输出下一页

#### 需要考虑的问题：
1. 当标准输入被重定向到 管道 或 文件 时，如何读取用户输入？
2. 如何使得用户的输入能够立刻被程序得到，而不用敲入回车？
3. 如何得到屏幕的大小？
4. 如何得到屏幕大小改变的情况？
5. 如何避免意外退出，终端未被重置的情况？

#### 程序主要解决的问题：
1. 通过打开 `/dev/tty` 使得任何情况都可以从键盘得到用户输入
2. 使用 `tcgetattr()` 和 `tcsetattr()` 设置终端不回显和无缓冲
3. 使用 `ioctl(fileno(fp_tty), TIOCGWINSZ, &wbuf);` 获取当前终端的大小
4. 通过捕获信号 `SIGWINCH` 得到窗口大小改变的情况
5. 每次意外退出前，都重置终端

#### 程序使用的其它技术
1. 使用 `printf("\033[7m--more--\033[m");` 反白提示符
2. 使用 `printf("\033[s");` 记录光标的位置
3. 使用 `printf("\033[1K");` 删除已输出的提示符
4. 使用 `printf("\033[u");` 恢复光标的位置
5. 使用 `stat()` 获取文件大小，用于输出百分比
6. 由于处理信号时，可能会修改变量的值，所以，为避免竟态问题，使用了两个原子变量

#### 程序未处理的问题：
当标准输入被重定向到文件时，可以通过读一次文件，获取文件大小，用于提示用户百分比，感觉得不偿失，所以未处理

#### 参考资源：
* [unix/linux 编程实践教程](https://book.douban.com/subject/1219329/)
* [维基百科](https://w.upupming.site/wiki/ANSI%E8%BD%AC%E4%B9%89%E5%BA%8F%E5%88%97)

