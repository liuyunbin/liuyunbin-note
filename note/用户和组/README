
## 为什么存在用户?
* 要登录一个系统, 肯定需要一个名称, 用以区分不同的用户

## 为什么存在组?
* 为了多个用户共享数据

## 用户, 用户名称, 用户ID, 组, 组名称, 组ID之间的关系
* 用户和用户名称一一对应, 组和组名称一一对应
* 一个用户只能对应一个用户ID, 一个组只能对应一个组ID
* 多个用户可以对应一个用户ID, 多个组可以对应一个组ID
* 一个用户可以对应多个组, 但只能有一个主组

## 用户名称和组名称有什么限制?
* 只能包含 大小写字母 数字 下划线 短横线 小数点, 末尾可以有 $
* 短横线不能在开头, 用以区分可选项和名称
* . 和 .. 不允许
* 不能重复
* 不能是纯数字, 因为一些命令同时接受 ID 和名称的形式
* 长度最多 32 位

## 为什么存在用户ID和组ID?
* 节省空间
* 提高比较的效率

## 用户ID和组ID有什么限制
* 必须大于等于 0
* 0 一般是 root 使用

## 用户的属性
* 用户名称, 用户ID, 组名称, 组ID, 附属组ID
* 主目录, 主目录模板
* 默认 shell
* 用户过期日期
* 锁定用户, 解锁用户
* 密码过期到临时不可用的时间
* 密码修改的最小最大间隔, 警告天数

## 当前终端的登录用户
* 经过终端或伪终端登录后, 不会再变化

## 当前终端的有效用户
* 经过终端或伪终端登录后, 通过 su 可再变化

## 其他命令
users  # 列出所有登陆用户
w      # 列出谁登录, 以及目前在干什么
who    # 列出谁登录
who -m # 列出当前终端登录的用户
whoami # 列出当前终端的有效用户

useradd          # 添加用户
                 #   可查看或修改默认配置
                 #   可指定主目录, 主目录模板, 用户ID, 主组ID, 附属组ID, shell, 用户过期日期等
useradd -D       # 查看默认配置
useradd -m -b .. # 指明主目录的父目录, 不存在的话新建
useradd -m -d .. # 指明主目录,         不存在的话新建
newusers         # 批量新增用户
usermod          # 修改用户
                 #   可修改用户名, 添加附属组, 锁定用户, 解锁用户, 移动主目录
                 #   其他选项同 useradd
chage            # 修改密码相关信息
                 #   包括列出密码相关信息
                 #   包括用户过期日期, 密码修改的最大最小间隔, 警告天数
chage -l   lyb   # 列出密码相关信息
chage -d 0 lyb   # 下次登录必须修改密码
chsh             # 列出或修改支 shell
chfn             # 修改个人信息, 手机号之类
passwd           # 修改密码
passwd -stdin    # 修改密码, 从标准输入读取
passwd    lyb    # 修改密码
userdel          # 删除用户
su               # 切到 root
su -             # 切到 root, 更新主目录, 环境变量等, 相当于重新登录
su   lyb         # 切到 lyb

groups    # 列出用户所属的组名称
groupadd  # 添加组
groupmod  # 修改组信息, 包括组的ID和组名称
groupdel  # 删除组
groupmems # 管理当前用户的主组, 新增或删除成员
gpasswd   # 管理组, 新增或删除成员, 删除密码, 设置组管理人员等
newgrp    # 切换组
sg        # 使用其他组执行命令

uptime -s # 列出系统启动时间

id        # 输出实际或有效用户的用户和组信息

last      # 列出最近保存的登录的信息
lastb     # 列出最近保存的登录的信息, 包括失败情况

lastlog           # 列出最近一次的登录信息
lastlog -b 10     # 最近一次的登录在 10 天前的信息
lastlog -t 10     # 最近一次的登录在 10 天内的信息
lastlog -C -u lyb # 清除 lyb 最近一次的登录信息
lastlog -S -u lyb # 设置 lyb 最近一次的登录信息
lastlog    -u lyb # 查看 lyb 最近一次的登录信息

sudo                                          # 权限管理文件: /etc/sudoers, 使用 visudo 编辑
sudo -u USERNAME COMMAND                      # 指定用户执行命令
sudo -S date -s "20210722 10:10:10" <<< "123" # 脚本中免密码使用
sudoedit ...                                  # 编辑文件

## 配置文件
* /etc/passwd          # 用户基本信息
* /etc/shadow          # 用户密码信息
* /etc/group           # 组基本信息
* /etc/gshadow         # 组密码信息
* /etc/default/useradd # useradd 默认配置
* /etc/skel/           # 默认主目录模板
* /etc/subgid          # 用户隶属的 GID
* /etc/subuid          # 用户隶属的 UID
* /etc/login.defs      # 有关登录的配置信息

