
## 文件时间
* atime # 内容读取时间, 更新可能不及时
* mtime # 内容修改时间
* ctime # 状态修改时间: 内容 名称 权限 所属者 所属组

## 文件权限
* 读, 写, 执行
* SUID:
    * 文件执行时, 拥有此文件所有者的权限
    * 只对二进制有效
* SGID:
    * 二进制文件: 文件执行时, 拥有此文件所属组的权限
    * 目录: 新增的文件所属的组是此目录所属的组
* SBIT: 此目录下的文件只有文件或目录所有者才可以删除
* 权限判断: 依次判断所属用户, 所属组和其他权限
    * 前者失败时, 不判断后者
    * 假如 1.cc 的权限为 0070,
    * 所属主无权限, 所属组有权限时,
    * 对所属主也将判断为无权限
* 在目录下新增或删除文件时, 至少拥有此目录的写和执行权限

## 日期和时间
### 基础概念
* 地球自转一圈为一天
* 地球公转一圈为一年
* 地球公转一圈时, 地球自转了 365.24219 圈, 所以, 一年等于 365.24219 天
* 为了修正误差, 区分了平年和闰年
* 规则(这样算完还有误差, 但误差就比较小了)
    * 如果遇到不是整百年, 且能被四  整除, 是闰年
    * 如果遇到  是整百年, 且能被四百整除, 是闰年
* 为什么不把一年直接定义为 365 天, 为了保证夏天始终热, 冬天始终冷, 否则就乱了
* 闰年的参照物是太阳
* 闰月的参照物是月亮
* 时间戳:
    * 距离 1970-01-01 00:00:00 +0000 的秒数, 不包括闰秒
    * 不受时区的影响, 所有时区都相同
    * 有的系统允许使用负数, 有的系统不允许

### GMT(格林威治时间)(已过时)
* 太阳经过格林威治天文台的时间为中午12点
* 这里说的一天不受地球自转速度的影响
* 地球转的快了, 一天就短, 一秒也变短, 慢了, 一天就长, 一秒也变长

### UTC(正在用)
* 原子时间: 一秒是精确的, 一天也是精确的(原子时间有误差, 但很小)
* 由于, 地球自转速度的变化, 导致和 GMT 的时间对不上, 由此, 产生了闰秒
* 好消息是: 2035 年要取消闰秒了

### 夏令时
* 进夏令时的那一天只有 23 个小时
* 出夏令时的那一天只有 25 个小时
* 其他日期都有 24 个小时
* 可以节约能源

### 时区
* 每 15 个经度一个时区
* 总共 24 个时区
* 相邻时区相差一个小时

### 配置
* /etc/default/locale -- 修改系统显示

### 常用函数
```
* time(time_t*)                                                 获取基于 1970-01-01 00:00:00 +0000 的时间戳
* struct tm*    gmtime(const time_t*)                           时间戳   --> 时间元组, +0000 utc
* struct tm* localtime(const time_t*)                           时间戳   --> 时间元组, 本地时间
* char *         ctime(const time_t*)                           时间戳   --> 字符串
* char *  asctime(const struct tm *tm)                          时间元组 --> 字符串
* size_t strftime(char*, size_t, const char*, const struct tm*) 时间元组 --> 字符串, 可以指定格式
* time     mktime(struct tm *tm)                                时间元组 --> 字符戳
* char *strptime(const char*, const char*, struct tm*)          字符串   --> 时间元组
* double difftime(time_t time1, time_t time0);                  两个时间戳的差值

time() => localtime() => strftime(): 时间戳 => 时间元组 => 字符串形式
strptime() => mktime()             : 字符串形式 => 时间元组 => 时间戳
```

## 软件安装
### 包管理器
#### 优点：
1. 安装，卸载 或 升级方便
2. 不容易对系统造成污染（可能性极小）
3. 不需要处理复杂的依赖关系

#### 缺点：
1. 需要有管理员权限
2. 安装的版本可能比较旧
3. 不能指定编译参数

### 源码编译到系统目录
#### 优点：
1. 可以安装指定的版本
2. 可以指定编译参数

#### 缺点：
1. 需要理员权限
2. 可能需要处理复杂的依赖关系
3. 可能会对系统造成污染
4. 安装，卸载 或 升级比较麻烦

### 源码编译到用户目录
#### 优点：
1. 可以安装指定的版本
2. 可以指定编译参数
3. 不会对系统造成污染
4. 不需要管理员权限（需要管理员提供编译工具）

#### 缺点：
1. 可能需要处理复杂的依赖关系
2. 安装，卸载 或 升级比较麻烦

### 个人建议：
1. 如果没有管理员权限，只能选择源码编译到用户目录
2. 如果有管理员权限，优先选择包管理器，而后选择编译安装到用户目录，尽量不要编译安装到系统目录

## 用户和组
### 为什么存在用户?
* 要登录一个系统, 肯定需要一个名称, 用以区分不同的用户

### 为什么存在组?
* 为了多个用户之间共享数据

### 用户, 用户名称, 用户ID, 组, 组名称, 组ID之间的关系
* 用户和用户名称一一对应, 组和组名称一一对应
* 一个用户只能对应一个用户ID, 一个组只能对应一个组ID
* 多个用户可以对应一个用户ID, 多个组可以对应一个组ID
* 一个用户可以对应多个组, 但只能有一个主组

### 用户名称和组名称有什么限制?
* 只能包含 大小写字母 数字 下划线 短横线 小数点, 末尾可以有 $
* 短横线不能在开头, 用以区分可选项和名称
* . 和 .. 不允许
* 不能重复
* 不能是纯数字, 因为一些命令同时接受 ID 和名称的形式
* 长度最多 32 位

### 为什么存在用户ID和组ID?
* 节省空间
* 提高比较的效率

### 用户ID和组ID有什么限制
* 必须大于等于 0
* 0 一般是 root 使用

### 用户的属性
* 用户名称, 用户ID, 组名称, 组ID, 附属组ID
* 主目录, 主目录模板
* 默认 shell
* 用户过期日期
* 锁定用户, 解锁用户
* 密码过期到临时不可用的时间
* 密码修改的最小最大间隔, 警告天数
* UID GID 的值一般默认即可, 不需要特殊设置

### 当前终端的登录用户
* 经过终端或伪终端登录后, 不会再变化

### 当前终端的有效用户
* 经过终端或伪终端登录后, 通过 su 可再变化

### 配置文件
```
/etc/passwd          # 用户基本信息
/etc/shadow          # 用户密码信息
/etc/group           # 组基本信息
/etc/gshadow         # 组密码信息
/etc/default/useradd # useradd 默认配置
/etc/skel/           # 默认主目录模板
/etc/subgid          # 用户隶属的 GID
/etc/subuid          # 用户隶属的 UID
/etc/login.defs      # 有关登录的配置信息
```

# 操作系统-打包和压缩
## 压缩命令需要考虑的问题
```
* 压缩, 能否压缩目录
* 压缩, 能否跳过文件
* 压缩, 能否跳过目录
* 压缩, 使用  精确名称跳过文件或目录时, 也会跳过子目录的文件或目录 -- 通用(不包括 zip gunzip, 下同)
* 压缩, 使用通配符名称跳过文件或目录时, 也会跳过子目录的文件或目录(假设没有和通配符相同的文件) -- 通用
* 压缩, 是否可以保留符号链接
* 压缩, 能否完整保留 Linux 权限, 比如 suid
* 压缩, 是否删除源文件
* 压缩, 目标文件已存在时, 怎么办?
* 解压, 是否可以指定解压目录
* 解压, 是否可以只解压部分文件
* 解压, 是否可以只解压部分目录
* 解压, 使用  精确名称指定部分文件或目录时, 需要从顶层目录开始指定 -- 通用
* 解压, 使用通配符名称指定部分文件或目录时, 也会跳过子目录的文件或目录(假设没有和通配符相同的文件) -- 通用
* 解压, 是否可以跳过部分文件
* 解压, 是否可以跳过部分目录
* 解压, 使用  精确名称跳过部分文件或目录时, 需要从顶层目录开始指定 -- 通用
* 解压, 使用通配符名称跳过部分文件或目录时, 也会跳过子目录的文件或目录(假设没有和通配符相同的文件) -- 通用
* 解压, 能否完整保留 Linux 权限, 比如 suid
* 解压, 是否删除源文件
* 解压, 目标文件已存在时, 怎么办?
* 查看, 查看部分文件或跳过部分文件要考虑的问题同解压
```

## tar
```
* 压缩, 能否压缩目录                            -- 可以(其实是先打包后压缩)
* 压缩, 能否跳过文件                            -- 可以
* 压缩, 能否跳过目录                            -- 可以
* 压缩, 是否可以保留符号链接                    -- 可以
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 压缩, 是否删除源文件                          -- 不会
* 压缩, 目标文件已存在时, 怎么办?               -- 删除旧文件, 生成新文件
* 解压, 是否可以指定解压目录                    -- 可以
* 解压, 是否可以只解压部分文件                  -- 可以
* 解压, 是否可以只解压部分目录                  -- 可以
* 解压, 是否可以跳过部分文件                    -- 可以
* 解压, 是否可以跳过部分目录                    -- 可以
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 解压, 是否删除源文件                          -- 不会
* 解压, 目标文件已存在时, 怎么办?               -- 更新压缩包里存在的文件, 压缩包里不存在的文件保持不变

tar             acf 1.tgz                   ... # 打包并压缩, 根据后缀自动选择压缩类型
tar            vacf 1.tgz                   ... # 打包并压缩, 显示压缩过程
tar             acf 1.tgz -X 1.txt          ... # 打包并压缩, 跳过 1.txt 内的文件
tar             acf 1.tgz --exclude "..."   ... # 打包并压缩, 跳过文件或目录
tar              xf 1.tgz                       # 解压, 根据后缀自动选择压缩类型
tar             vxf 1.tgz                       # 解压, 显示解压过程
tar             pxf 1.tgz                       # 解压, 完整还原权限, 比如, suid
tar              xf 1.tgz -C ...                # 解压, 指定解压目录
tar              xf 1.tgz            1.txt      # 解压部分文件或目录, 精确
tar --wildcards -xf 1.tgz           "*.txt"     # 解压部分文件或目录, 通配符, 有的版本不需要 --wildcards
tar              xf 1.tgz --exclude  1.txt      # 解压跳过部分文件或目录, 精确
tar --wildcards -xf 1.tgz --exclude "*.txt"     # 解压跳过部分文件或目录, 通配符, 有的版本不需要 --wildcards
tar              tf 1.tgz                       # 列出压缩包中的文件和目录, 根据后缀自动选择压缩类型
tar             vtf 1.tgz                       # 列出压缩包中的文件和目录, 包括权限, 所属用户等
tar              tf 1.tgz  ...                  # 列出压缩包中的指定文件或目录, 说明同解压

tar cf 1.tar ... # 打包
tar xf 1.tar     # 解包
tar tf 1.tar     # 查看包
tar rf 1.tar ... # 添加包
tar uf 1.tar ... # 更新包

tar zcf 1.tgz ... # 打包并压缩 gzip
tar zxf 1.tgz     # 解压并解包 gzip
tar ztf 1.tgz     # 查看

tar zcf 1.tar.gz ... # 打包并压缩 gzip
tar zxf 1.tar.gz     # 解压并解包 gzip
tar ztf 1.tar.gz     # 查看

tar jcf 1.tar.bz2 ... # 打包并压缩 bz2
tar jxf 1.tar.bz2     # 解压并解包 bz2
tar jtf 1.tar.bz2     # 查看

tar Zcf 1.Z ... # 打包并压缩 compress
tar Zxf 1.Z     # 解压并解包 compress
tar Ztf 1.Z     # 查看
```

## gzip gunzip
```
* 压缩, 能否压缩目录                            -- 不能
* 压缩, 能否跳过文件                            -- 不能, 只有一个文件
* 压缩, 能否跳过目录                            -- 不能
* 压缩, 是否可以保留符号链接                    -- 不能, 只有一个文件, 符号链接没意义
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 会
* 压缩, 目标文件已存在时, 怎么办?               -- 会提醒是否覆盖
* 解压, 是否可以指定解压目录                    -- 不能
* 解压, 是否可以只解压部分文件                  -- 不能, 只有一个文件
* 解压, 是否可以只解压部分目录                  -- 不能
* 解压, 是否可以跳过部分文件                    -- 不能, 只有一个文件
* 解压, 是否可以跳过部分目录                    -- 不能
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 会
* 解压, 目标文件已存在时, 怎么办?               -- 会提醒是否覆盖

gzip      ...       #     压缩
gzip  -r ....       # 递归压缩
gzip  -l 1.gz       #     列出 1.gz 内文件
gzip  -d 1.gz       #   解压缩
gunzip   1.gz       #   解压缩
gunzip   1.tgz      #   解压缩
```

## bzip2 bunzip2
```
* 压缩, 能否压缩目录                            -- 不能
* 压缩, 能否跳过文件                            -- 不能, 只有一个文件
* 压缩, 能否跳过目录                            -- 不能
* 压缩, 是否可以保留符号链接                    -- 不能, 只有一个文件, 符号链接没意义
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 默认会删除
* 压缩, 目标文件已存在时, 怎么办?               -- 默认会报错
* 解压, 是否可以指定解压目录                    -- 不能
* 解压, 是否可以只解压部分文件                  -- 不能, 只有一个文件
* 解压, 是否可以只解压部分目录                  -- 不能
* 解压, 是否可以跳过部分文件                    -- 不能, 只有一个文件
* 解压, 是否可以跳过部分目录                    -- 不能
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 默认会删除
* 解压, 目标文件已存在时, 怎么办?               -- 默认会报错

bzip2       ...    #   压缩,   删除源文件, 目标文件已存在时报错
bzip2   -f  ...    #   压缩,   删除源文件, 目标文件已存在时覆盖
bzip2   -k  ...    #   压缩, 不删除源文件
bzip2   -v  ...    #   压缩,   显示压缩过程
bzip2   -q  ...    #   压缩, 不显示压缩过程
bzip2   -d  1.bz2  # 解压缩, 其他组合选项同压缩
bunzip2     1.bz2  # 解压缩, 其他组合选项同压缩
```

## compress uncompress
```
* 压缩, 能否压缩目录                            -- 不能
* 压缩, 能否跳过文件                            -- 不能, 只有一个文件
* 压缩, 能否跳过目录                            -- 不能
* 压缩, 是否可以保留符号链接                    -- 不能, 只有一个文件, 符号链接没意义
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 会
* 压缩, 目标文件已存在时, 怎么办?               -- 默认会提醒是否覆盖
* 解压, 是否可以指定解压目录                    -- 不能
* 解压, 是否可以只解压部分文件                  -- 不能, 只有一个文件
* 解压, 是否可以只解压部分目录                  -- 不能
* 解压, 是否可以跳过部分文件                    -- 不能, 只有一个文件
* 解压, 是否可以跳过部分目录                    -- 不能
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 会
* 解压, 目标文件已存在时, 怎么办?               -- 默认会提醒是否覆盖

  compress    ...  #   压缩, 目标文件已存在时可选择是否覆盖
  compress -f ...  #   压缩, 目标文件已存在时覆盖
  compress -r ...  #   压缩, 递归
  compress -d 1.Z  # 解压缩, 其他组合选项同压缩
uncompress    1.Z  # 解压缩, 其他组合选项同压缩
```

## zip unzip
```
* 压缩, 能否压缩目录                            -- 可以
* 压缩, 能否跳过文件                            -- 可以
* 压缩, 能否跳过目录                            -- 可以
* 压缩, 是否可以保留符号链接                    -- 默认使用符号链接所指向的文件
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 压缩, 是否删除源文件                          -- 默认不会
* 压缩, 目标文件已存在时, 怎么办?               -- 不会删除旧文件, 只会更新旧文件
* 解压, 是否可以指定解压目录                    -- 可以
* 解压, 是否可以只解压部分文件                  -- 可以
* 解压, 是否可以只解压部分目录                  -- 可以
* 解压, 是否可以跳过部分文件                    -- 可以
* 解压, 是否可以跳过部分目录                    -- 可以
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 不能
* 解压, 是否删除源文件                          -- 默认不会
* 解压, 目标文件已存在时, 怎么办?               -- 默认会提醒

zip     1.zip ...             # 压缩文件
zip -r  1.zip ...             # 压缩目录
zip -r  1.zip ... -x  1.txt   # 压缩, 跳过指定文件, 需要从顶层目录开始
zip -r  1.zip ... -x  "111/"  # 压缩, 跳过指定空目录, 需要从顶层目录开始, 精确 (必须包含斜杠)
zip -r  1.zip ... -x  "111/*" # 压缩, 跳过指定  目录, 需要从顶层目录开始, 精确
zip -r  1.zip ... -x "*.txt"  # 压缩, 跳过指定文件,   包括子目录, 通配符, 假设不存在文件 *.txt
zip -rj 1.zip    ...          # 压缩, 所有文件都移到顶层目录
zip -l  1.zip    ...          # 压缩 LF -> LF+CR
zip -ll 1.zip    ...          # 压缩 LF+CR -> LF
zip -m  1.zip    ...          # 压缩, 删除原始文件
zip -q  1.zip    ...          # 压缩, 不显示指令执行过程
zip -y  1.zip    ...          # 压缩, 保存符号链接本身
zip -d  1.zip   1.txt         # 删除 1.zip 里的文件, 需要从顶层路径开始, 精确
zip -d  1.zip  "123/"         # 删除 1.zip 里的空目录, 需要从顶层路径开始, 精确 (必须包含斜杠)
zip -d  1.zip  "123/*"        # 删除 1.zip 里的  目录, 需要从顶层路径开始, 精确
zip -d  1.zip "*.txt"         # 删除 1.zip 里的文件, 包括子目录, 通配符, 假设不存在文件 *.txt
zip -f  1.zip    ...          # 更新 1.zip 里的文件, 不添加
zip -u  1.zip    ...          # 更新 1.zip 里的文件, 不存在时添加, 感觉和默认行为没什么区别
zip -v  1.zip    ...          # 显示执行过程

unzip    1.zip               # 解压
unzip    1.zip   1.txt       # 解压部分文件, 精确, 需要从顶层路径开始
unzip    1.zip    123/       # 解压部分空目录, 精确, 需要从顶层路径开始 (必须包含斜杠)
unzip    1.zip   "123/*"     # 解压部分  目录, 精确, 需要从顶层路径开始
unzip    1.zip   "*.txt"     # 解压部分文件, 通配符, 包括子目录, 假设不存在文件 *.txt
unzip    1.zip -x ...        # 解压缩, 跳过指定文件或目录, 规则同上
unzip    1.zip -d ...        # 解压缩到指定目录
unzip -j 1.zip               # 解压时, 文件都移到顶层路径
unzip -o 1.zip               # 解压时, 直接覆盖重复的文件, 不提醒
unzip -n 1.zip               # 解压时,   不覆盖重复的文件
unzip -l 1.zip               # 列出 1.zip 的目录结构, 简单
unzip -v 1.zip               # 列出 1.zip 的目录结构, 详细点
```

## rar unrar
```
* 压缩, 能否压缩目录                            -- 可以
* 压缩, 能否跳过文件                            --
* 压缩, 能否跳过目录                            --
* 压缩, 是否可以保留符号链接                    -- 默认使用符号链接所指向的文件
* 压缩, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 压缩, 是否删除源文件                          -- 不会
* 压缩, 目标文件已存在时, 怎么办?               -- 不会删除旧文件, 只会更新旧文件
* 解压, 是否可以指定解压目录                    -- 可以
* 解压, 是否可以只解压部分文件                  -- 可以
* 解压, 是否可以只解压部分目录                  -- 可以
* 解压, 是否可以跳过部分文件                    --
* 解压, 是否可以跳过部分目录                    --
* 解压, 能否完整保留 Linux 权限, 比如 suid      -- 可以
* 解压, 是否删除源文件                          -- 不会
* 解压, 目标文件已存在时, 怎么办?               -- 会提醒

rar      a 1.rar ...      #   压缩文件或目录
rar -ol  a 1.rar ...      #   压缩文件或目录, 保留符号链接本身
unrar    v 1.rar          # 列出压缩包信息, 详细
unrar    l 1.rar          # 列出压缩包信息, 简易
unrar    l 1.rar ...      # 列出压缩包内的指定文件或目录
unrar    e 1.rar ...      # 解压缩到指定路径, 忽略压缩包内的路径
unrar    x 1.rar ...      # 解压缩到指定路径, 使用完整的压缩包路径
unrar    x 1.rar ... ...  # 解压缩到指定路径, 使用完整的压缩包路径, 只解压部分文件
```

